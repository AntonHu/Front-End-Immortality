# 前端性能衡量-RAIL模型

## RAIL模型

**RAIL** 是一种以用户为中心的性能模型，提供考虑性能的结构。它将用户体验细分为关键操作（例如点按、滚动、加载），表示 Web 应用生命周期的四个不同方面：响应、动画、空闲和加载。



![1739426516260](https://image.antoncook.xyz/picGo/1739426516260.jpg)

让用户成为性能工作的中心。下表介绍了用户如何看待性能延迟的关键指标：

用户对性能延迟的感知

| 0 至 16 毫秒     | 用户非常擅长跟踪运动，如果动画不流畅，他们就会不喜欢。只要每秒渲染 60 帧，这类动画就会感觉很流畅。也就是每帧 16 毫秒（包括浏览器将新帧绘制到屏幕上所需的时间），让应用生成一帧大约 10 毫秒。 |
| ---------------- | ------------------------------------------------------------ |
| 0 至 100 毫秒    | 在此时间范围内响应用户操作，让用户感觉能够立竿见影。时间再长，操作与反应之间的连接就会中断。 |
| 100 至 1000 毫秒 | 在此窗口中，事情感觉像是任务自然和持续推进的一部分。对于网络上的大多数用户，加载页面或更改视图代表着一个任务。 |
| 1000 毫秒或以上  | 一旦超过 1,000 毫秒（1 秒），用户就会失去专注于他们正在执行的任务的注意力。 |
| 10000 毫秒或更长 | 一旦超过 10,000 毫秒（10 秒），用户就会感到沮丧，并可能放弃任务。他们以后不一定会回来。 |

## Response

在 **100ms** 内完成由用户输入发起的转换，让用户感觉互动是瞬时完成的。

**50ms** 内处理事件：虽然100ms即可达到及时交互的体验，但是其他任务也会有执行时间，加上下一个输入交互也在排队中，所以需要50ms内处理事件。

![1739435486005](https://image.antoncook.xyz/picGo/1739435486005.jpg)

## Animation

在 10 毫秒或更短的时间内生成动画中的每一帧。从技术上讲，每一帧的最大预算为 16 毫秒（1000 毫秒 / 60 帧/秒约 16 毫秒），但浏览器需要大约 6 毫秒才能渲染每一帧，因此准则是每帧 10 毫秒。

浏览器一帧要处理的事情：

![image-20250213163900928](https://image.antoncook.xyz/picGo/image-20250213163900928.png)

ps：通过数据统计我们一般认为 **24FPS**，是人眼获取动画信息，不会觉得卡顿的最低帧率要求，也就是41ms。

## Idle

尽可能加大空闲时间以提高50ms内响应用户操作的几率。

## Load

根据用户的设备和网络功能进行优化，以实现快速加载性能。目前，在 3G 网速较慢的中端移动设备上加载网页并可在 [5 秒或更短的时间内](https://web.dev/articles/performance-budgets-101?hl=zh-cn#establish_a_baseline)加载网页是一个不错的目标。对于后续加载，最好在 2 秒内加载页面。

**页面渲染流程**

![1739434196299](https://image.antoncook.xyz/picGo/1739434196299.jpg)

## 