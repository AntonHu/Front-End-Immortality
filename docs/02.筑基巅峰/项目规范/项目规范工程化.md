# å‰ç«¯é¡¹ç›®è§„èŒƒè‡ªåŠ¨åŒ–

æ­å»ºå‰ç«¯é¡¹ç›®è§„èŒƒï¼Œå¯ä»¥è®©å›¢é˜Ÿåä½œçš„é¡¹ç›®éµå¾ªç»Ÿä¸€çš„é£æ ¼ï¼Œä¾¿äºç»´æŠ¤å’Œç¾è§‚æ˜“è¯»ï¼Œå†åŠ ä¸Šè‡ªåŠ¨åŒ–çš„æµç¨‹èƒ½è®©è§„èŒƒçš„éµå¾ªæ›´å®¹æ˜“ï¼Œä¹Ÿæ›´é«˜æ•ˆï¼Œé™ä½ç®¡ç†å¿ƒæ™ºï¼Œä»¥ä¸‹æˆ‘æ•´ç†äº†ä¸»æµå‰ç«¯é¡¹ç›®çš„è§„èŒƒè‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œæœ€ç»ˆå°†å½¢æˆå¦‚ä¸‹çš„é¡¹ç›®ç»“æ„ï¼š

```js
my-project/
â”œâ”€â”€ .husky/ -------------------------------- gitæ‹¦æˆª
â”‚   â”œâ”€â”€ commit-msg ------------------------- æ‰§è¡Œcommitlint
â”‚   â”œâ”€â”€ commit-wizard.js ------------------- commit messageè¾…åŠ©ç”Ÿæˆè„šæœ¬
â”‚   â”œâ”€â”€ pre-commit ------------------------- æ‰§è¡Œlint-staged
â”‚   â””â”€â”€ prepare-commit-msg ----------------- æ‰§è¡Œcommit messageè¾…åŠ©ç”Ÿæˆå·¥å…·æˆ–è„šæœ¬
â”œâ”€â”€ .vscode/ ------------------------------- vscodeå¼€å‘ç¯å¢ƒè§„èŒƒ
â”‚   â””â”€â”€ settings.json
â”œâ”€â”€ .editorconfig -------------------------- IDEç¼–ç æ ·å¼è§„èŒƒ
â”œâ”€â”€ eslint.config.js ----------------------- å‰ç«¯ä»£ç æ£€æŸ¥ä¸è§„èŒƒ
â”œâ”€â”€ .prettierrc.json ----------------------- ç¼–å†™é£æ ¼è§„èŒƒ
â”œâ”€â”€ .commitlintrc.js ----------------------- commit messageè§„èŒƒ
â”œâ”€â”€ .lintstagedrc.json --------------------- è‡ªåŠ¨åŒ–è§„èŒƒä¿®å¤
â”œâ”€â”€ .cz-config.js -------------------------- commit messageè¾…åŠ©ç”Ÿæˆå·¥å…·
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json -------------------------- Typescriptè§„èŒƒ
```

## IDEè§„èŒƒ

### .editorconfig

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `.editorconfig` æ–‡ä»¶ï¼Œå¯ä»¥çº¦æŸæ–‡ä»¶åœ¨ä¸åŒçš„ç¼–è¾‘å™¨å’ŒIDEä¹‹é—´å®šä¹‰å’Œç»´æŠ¤ä¸€è‡´çš„ç¼–ç æ ·å¼

```js
# http://editorconfig.org
root = true

[*]
indent_style = space
indent_size = 2
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.md]
trim_trailing_whitespace = false
```

### .vscode

é€šè¿‡vscodeé…ç½®æ–‡ä»¶ã€‚å¯ä»¥è®©å›¢é˜Ÿåœ¨å„è‡ªçš„ç”µè„‘ä¸Šä½¿ç”¨IDEè¿›è¡Œå¼€å‘æ—¶ï¼Œéƒ½ä½¿ç”¨ç»Ÿä¸€IDEé…ç½®ç¯å¢ƒï¼Œä¾‹å¦‚æ’ä»¶çš„ä½œç”¨èŒƒå›´ä½¿ç”¨è§„åˆ™ç­‰ã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `.vscode` æ–‡ä»¶å¤¹ï¼Œä¸‹é¢å†åˆ›å»ºä¸€ä¸ª `settings.json` æ–‡ä»¶ï¼š

```json
{
  // åœ¨ä¿å­˜æ—¶è‡ªåŠ¨è¿›è¡Œä»£ç æ ¼å¼åŒ–
  "editor.formatOnSave": true,
  // è®¾ç½®é»˜è®¤çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ä¸º Prettier
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  // åœ¨ä¿å­˜æ—¶è¿è¡Œ ESLint æ’ä»¶è¿›è¡Œä»£ç ä¿®å¤
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "explicit"
  },
  // é’ˆå¯¹ JavaScript æ–‡ä»¶ï¼Œç¦ç”¨ä¿å­˜æ—¶çš„è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œé€šè¿‡ ESLint è¿›è¡Œä¿®å¤
  "[javascript]": {
    "editor.formatOnSave": false
  },
  // é’ˆå¯¹ JavaScript React æ–‡ä»¶ï¼Œç¦ç”¨ä¿å­˜æ—¶çš„è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œé€šè¿‡ ESLint è¿›è¡Œä¿®å¤
  "[javascriptreact]": {
    "editor.formatOnSave": false
  },
  // é’ˆå¯¹ TypeScript æ–‡ä»¶ï¼Œç¦ç”¨ä¿å­˜æ—¶çš„è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œé€šè¿‡ ESLint è¿›è¡Œä¿®å¤
  "[typescript]": {
    "editor.formatOnSave": false
  },
  // é’ˆå¯¹ Vue æ–‡ä»¶ï¼Œè®¾ç½®é»˜è®¤çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ä¸º ESLint
  "[vue]": {
    "editor.defaultFormatter": "dbaeumer.vscode-eslint"
  }
}
```

## ä»£ç è§„èŒƒ

### TypeScript

åœ¨é¡¹ç›®ä¸­é›†æˆtså¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œä¹Ÿè‡ªå¸¦äº†é£æ ¼å’Œä»£ç çš„çº¦æŸä¸é™æ€æ£€æŸ¥ï¼Œå†™å‡ºå®¹é”™æ›´é«˜çš„ä»£ç ã€‚

åœ¨é¡¹ç›®ä¸­é›†æˆts

```bash
npm install -D typescript
```

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Viteæ„å»ºé¡¹ç›®ï¼Œç›´æ¥é…ç½®tsconfig.jsonå³å¯ï¼Œå¦‚æœæ˜¯webpackæ„å»ºé¡¹ç›®è¿˜éœ€è¦å®‰è£…babelé¢„è®¾

```bash
npm install -D @babel/preset-typescript
```

ç„¶ååœ¨ä½ é¡¹ç›®çš„babelé…ç½® `.babelrc.js` ä¸­ä½¿ç”¨è¿™ä¸ªé¢„è®¾

```js
// æ ¹ç›®å½•.babelrc.jsï¼Œæˆ–è€…å†™å…¥ä½ çš„webpacké…ç½®ä¸­
{
  // ...å…¶ä»–é…ç½®
  "presets": [
    // ... å…¶ä»–é…ç½®
    "@babel/preset-typescript"
  ]
} 
```

`tsconfig.json`é…ç½®

```js
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "skipLibCheck": true,
    "outDir": "dist",
    "rootDir": "src",
    "declaration": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}

```

### Eslint

eslintå¯ä»¥æ£€æŸ¥jsï¼Œtsï¼Œjsxï¼Œtsxæ–‡ä»¶çš„é™æ€é”™è¯¯å’Œè§„èŒƒï¼Œé€šè¿‡åœ¨æ ¹ç›®å½•ç›®å½•åˆ›å»º`eslint.config.js`é…ç½®æ–‡ä»¶ï¼Œæ—§ç‰ˆçš„eslintæ˜¯.eslintrc.jsonã€‚

å®‰è£…eslintå’Œéœ€è¦çš„æ’ä»¶

```bash
npm install -D \
  eslint \
  eslint-config-prettier \
  eslint-plugin-prettier \
  @typescript-eslint/eslint-plugin \
  @typescript-eslint/parser 
```

é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºé…ç½®æ–‡ä»¶ `eslint.config.js` ï¼š

```js
import eslint from "@eslint/js";
import tsPlugin from "@typescript-eslint/eslint-plugin";
import tsParser from "@typescript-eslint/parser";
import prettierPlugin from "eslint-plugin-prettier";
import prettierConfig from "eslint-config-prettier";
import globals from "globals";

export default [
  // ä½¿ç”¨ ESLint æ¨èé…ç½®
  eslint.configs.recommended,

  // ä½¿ç”¨ @typescript-eslint æ¨èé…ç½®
  {
    files: ["**/*.ts", "**/*.tsx"],
    languageOptions: {
      parser: tsParser, // æŒ‡å®š TypeScript è§£æå™¨
      ecmaVersion: "latest",
      sourceType: "module",
    },
    plugins: {
      "@typescript-eslint": tsPlugin,
    },
    rules: {
      "@typescript-eslint/no-explicit-any": "off", // å…³é—­ any ç±»å‹è­¦å‘Š
      // ç¦ç”¨åŸºç¡€è§„åˆ™ï¼Œå¯ç”¨ TypeScript å¢å¼ºè§„åˆ™
      "no-unused-vars": "off",
      "@typescript-eslint/no-unused-vars": [
        "error",
        {
          argsIgnorePattern: "^_", // å¿½ç•¥ä»¥ _ å¼€å¤´çš„å‚æ•°
          varsIgnorePattern: "^_", // å¿½ç•¥ä»¥ _ å¼€å¤´çš„å˜é‡
          caughtErrorsIgnorePattern: "^_", // å¿½ç•¥ä»¥ _ å¼€å¤´çš„é”™è¯¯å˜é‡
        },
      ],
    },
  },

  // ä½¿ç”¨ Prettier é…ç½®
  {
    plugins: {
      prettier: prettierPlugin,
    },
    rules: {
      ...prettierConfig.rules,
      "prettier/prettier": "error", // å¯ç”¨ Prettier è§„åˆ™
    },
  },

  // å…¨å±€è§„åˆ™
  {
    languageOptions: {
      globals: {
        ...globals.node,
      },
    },
    rules: {
      "no-console": process.env.NODE_ENV === "production" ? "warn" : "off", // ç”Ÿäº§ç¯å¢ƒç¦ç”¨ console
      "no-debugger": process.env.NODE_ENV === "production" ? "warn" : "off", // ç”Ÿäº§ç¯å¢ƒç¦ç”¨ debugger
    },
  },

  // æ’é™¤æ–‡ä»¶
  {
    ignores: ["node_modules", "dist"],
  },
];
```

## é£æ ¼è§„èŒƒ

### Prettier

prettieråˆ™æ˜¯åœ¨ä¹¦å†™é£æ ¼ä¸Šçš„è§„èŒƒçº¦æŸï¼Œä»–ä¸åƒeslinté‚£æ ·æ£€æŸ¥ä»£ç ï¼Œè€Œæ˜¯è§„èŒƒç¼–å†™çš„ä¹ æƒ¯ï¼Œä¸”ä¸å±€é™äºjsæ–‡ä»¶ï¼Œå¯¹æ‰€æœ‰æ–‡ä»¶å‡å¯ç”Ÿæ•ˆã€‚

å®‰è£…

```bash
npm install -D prettier 
```

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `perttier.json `é…ç½®æ–‡ä»¶

```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": false,
  "trailingComma": "all",
  "bracketSpacing": true,
  "arrowParens": "always",
  "endOfLine": "auto"
}
```

## gitæ‹¦æˆª

huskyæä¾›gité’©å­ï¼Œå¯ä»¥ç›‘å¬gitæŒ‡ä»¤å¯¹æŒ‡å®šç¯èŠ‚è¿›è¡Œæ‹¦æˆªï¼Œä»è€Œæ»¡è¶³ä¸€äº›é¢å¤–çš„å®šåˆ¶åŒ–å¤„ç†ã€‚

å®‰è£…husky

```bas
npx husky install
npm pkg set scripts.prepare="husky install"
```

æ‰§è¡Œä»¥ä¸ŠæŒ‡ä»¤åï¼Œé¡¹ç›®æ ¹ç›®å½•å°±ä¼šæ–°å¢`.husky`æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨package.jsonä¸­å¢åŠ äº†`prepare`è„šæœ¬ï¼Œè¿™æ ·huskyéå®‰è£…å¥½å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼Œé’©å­çš„å…·ä½“ä½¿ç”¨è¯·çœ‹ä¸‹é¢çš„å†…å®¹ã€‚

## gitç¼“å­˜

lint-stagedå¯ä»¥è‡ªåŠ¨æ‰§è¡Œeslintå’Œprettierï¼Œåœ¨æäº¤ä»£ç ä¹‹å‰ï¼Œè¿›è¡Œä»£ç æ£€æŸ¥çš„è‡ªåŠ¨åŒ–å¤„ç†ï¼Œä¸ä»…æ£€æŸ¥ä»£ç ä¹Ÿä¼šä¿®å¤ä»£ç é—®é¢˜ï¼Œä¸è¿‡å»ºè®®åœ¨æäº¤ä¹‹å‰æ‰‹åŠ¨æ‰§è¡Œlint-stageï¼Œä»¥å…ä»£ç è°ƒæ•´åå‡ºç°bugã€‚é™¤æ­¤ä¹‹å¤–ï¼Œlint-stageè¿˜æœ‰gitæš‚å­˜åŒºçš„diffåŠŸèƒ½ï¼Œè¿™æ ·å¯ä»¥è®©ä»£ç çš„æ£€æŸ¥å’Œä¿®å¤åªä½œç”¨äºæœ¬æ¬¡gitæäº¤æœ‰å˜åŒ–çš„æ–‡ä»¶ï¼Œæé«˜è§„èŒƒå¤„ç†çš„æ•ˆç‡ã€‚

`.lintstagedrc.json `æ–‡ä»¶é…ç½®ï¼š

```json
{
  "*.{js,jsx,ts,tsx}": [
    "prettier --write",
    "eslint --fix --max-warnings=0"
  ],
  "*.{css,scss,less,md,json}": [
    "prettier --write"
  ]
}
```

ç„¶åæ·»åŠ huskyçš„pre-commité’©å­ï¼Œè‡ªåŠ¨æ‰§è¡Œlint-stagedï¼š

```bahs
npx husky add .husky/pre-commit "npx lint-staged"
```

## commitè§„èŒƒ

å³ä¾¿æœ‰äº†huskyç­‰gitæ‹¦æˆªï¼Œä»ç„¶æŒ¡ä¸ä½æœ‰ä¸€äº›é€šè¿‡è„šæœ¬æˆ–å·¥å…·åº“ç­‰ç»•è¿‡huskyç›‘å¬è¿›è¡Œæäº¤çš„è¡Œä¸ºï¼Œè€Œä½¿ç”¨ `commitlint` å·¥å…·ï¼Œå¯ä»¥åœ¨git commitçš„æœ€åç¯èŠ‚è¿›è¡Œmessageçš„æ ¡éªŒï¼Œè¿›ä¸€æ­¥é˜²èŒƒä¸ç¬¦åˆè§„èŒƒçš„æ„å¤–æäº¤ã€‚

å®‰è£…

```bash
npm install -D @commitlint/cli @commitlint/config-conventional
```

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º`.commitlintrc.js` é…ç½®æ–‡ä»¶

```js
export default {
  extends: ["@commitlint/config-conventional"],
  rules: {
    "type-enum": [
      2,
      "always",
      [
        "feat", // æ–°åŠŸèƒ½
        "fix", // bugä¿®å¤
        "docs", // æ–‡æ¡£å˜æ›´
        "style", // æ ·å¼/æ ¼å¼
        "refactor", // é‡æ„ï¼ˆä¸å¢åŠ åŠŸèƒ½ï¼‰
        "perf", // æ€§èƒ½ä¼˜åŒ–
        "test", // æµ‹è¯•ç”¨ä¾‹
        "chore", // æ„å»º/å·¥å…·
        "revert", // å›æ»š
        "release", // å‘å¸ƒ
      ],
    ],
    "subject-case": [0], // ä¸é™åˆ¶subjectå¤§å°å†™
  },
};

```

ç„¶ååœ¨huskyä¸­å¢åŠ `commit-msg`é’©å­ï¼Œæ‰§è¡Œcommitlintï¼š

```bash
npx husky add .husky/commit-msg 'npx --no -- commitlint --edit "$1"'
```

## commitè¾…åŠ©

æ‰‹åŠ¨è¾“å…¥commitå¤ªç¹çä¸”æ˜“é”™ï¼Œé€šè¿‡è®¾è®¡äº¤äº’çš„å½¢å¼è¾…åŠ©ç¼–å†™ï¼Œæ›´å‡†ç¡®ä¹Ÿæ›´é«˜æ•ˆï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨å·¥å…· `Commitizen` å¿«é€Ÿé…ç½®ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–å†™è„šæœ¬é«˜å®šåˆ¶å¯æ§ï¼š

| ç»´åº¦           | Commitizen               | æ‰‹å†™è„šæœ¬                     |
| :------------- | :----------------------- | :--------------------------- |
| **çµæ´»æ€§**     | ä¾èµ–é€‚é…å™¨ï¼Œä¿®æ”¹æˆæœ¬è¾ƒé«˜ | å®Œå…¨å¯æ§ï¼Œå¯å¿«é€Ÿå“åº”ä¸šåŠ¡å˜åŒ– |
| **ä¾èµ–å¤æ‚åº¦** | éœ€å®‰è£… cz-* ç³»åˆ—å·¥å…·é“¾   | ä»…éœ€ husky + inquirer        |
| **å­¦ä¹ æ›²çº¿**   | éœ€ç†è§£é€‚é…å™¨é…ç½®é€»è¾‘     | ç›´æ¥ä½¿ç”¨ Node.js å¼€å‘é€»è¾‘    |
| **å®šåˆ¶åŒ–èƒ½åŠ›** | å—é™äºé€‚é…å™¨æ‰©å±•æœºåˆ¶     | å¯è‡ªç”±è®¾è®¡äº¤äº’æµç¨‹å’Œæ ¡éªŒè§„åˆ™ |
| **ç»´æŠ¤æˆæœ¬**   | ä¾èµ–ç¤¾åŒºç»´æŠ¤é€‚é…å™¨       | è‡ªä¸»ç»´æŠ¤ï¼Œé—®é¢˜å®šä½ç›´æ¥       |
| **å¯åŠ¨é€Ÿåº¦**   | éœ€è¦åŠ è½½é¢å¤–ä¾èµ–         | è½»é‡çº§ï¼Œå¯åŠ¨æ›´å¿«             |

### æ‰‹å†™è„šæœ¬

åœ¨`.husky`æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºè„šæœ¬æ–‡ä»¶ `commit-wizard.js` 

ç„¶ååˆ›å»ºhuskyé’©å­ `prepare-commit-msg` ï¼Œå¹¶å†™å…¥æ‰§è¡Œäº¤äº’è„šæœ¬çš„æŒ‡ä»¤ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‡ä»¤å¯ä»¥å¿«é€Ÿåˆ›å»ºï¼š

```bash
npx husky add .husky/prepare-commit-msg "exec < /dev/tty && node .husky/commit-wizard.js"
```

`commit-wizard.js` è„šæœ¬å‚è€ƒï¼š

```js
#!/usr/bin/env node
import fs from "fs";
import inquirer from "inquirer";
import chalk from "chalk";
import { execSync } from "child_process";

/** é€šè¿‡åˆ†æ”¯åç§°è·å–é»˜è®¤çš„commit type */
const getBranchInfo = () => {
  const branch = execSync("git branch --show-current").toString().trim();

  return {
    issue: branch.match(/^(fix|feat)\/(\w+-\d+)/)?.[2],
    type: branch.match(/^(feat|fix|hotfix)/)?.[1],
  };
};

// è·å– Git æäº¤ä¿¡æ¯æ–‡ä»¶è·¯å¾„
const commitMsgFile = process.argv[2]
// å®šä¹‰ Git Commitç±»å‹ï¼Œå°½é‡ç¬¦åˆè§„èŒƒ
const commitTypes = [
  { name: "âœ¨ æ–°åŠŸèƒ½ (feat)", value: "feat" },
  { name: "ğŸ› Bugä¿®å¤ (fix)", value: "fix" },
  { name: "ğŸ“š æ–‡æ¡£å˜æ›´ (docs)", value: "docs" },
  { name: "ğŸ¨ ä»£ç æ ·å¼ (style)", value: "style" },
  { name: "â™»ï¸ ä»£ç é‡æ„ (refactor)", value: "refactor" },
  { name: "âš¡ï¸ æ€§èƒ½ä¼˜åŒ– (perf)", value: "perf" },
  { name: "âœ… æµ‹è¯•ç”¨ä¾‹ (test)", value: "test" },
  { name: "ğŸ”§ æ„å»ºå·¥å…· (chore)", value: "chore" },
  { name: "âš¡ï¸ å‘å¸ƒç‰ˆæœ¬ (release)", value: "release" },
  { name: "âª å›æ»šæäº¤ (revert)", value: "revert" },
];

async function run() {
  try {
    const answers = await inquirer.prompt([
      {
        type: "list",
        name: "type",
        message: "é€‰æ‹©æäº¤ç±»å‹:",
        choices: commitTypes,
        pageSize: 10,
        default: () => getBranchInfo().type || "feat",
      },
      {
        type: "input",
        name: "scope",
        message: ({ type }) => `è¾“å…¥å½±å“èŒƒå›´ (${type}):`,
        validate: (input) => !!input.trim() || "ä½œç”¨åŸŸä¸èƒ½ä¸ºç©º!",
      },
      {
        type: "input",
        name: "subject",
        message: "è¾“å…¥ç®€çŸ­æè¿°:",
        validate: (input) => {
          if (!input.trim()) return "æè¿°ä¸èƒ½ä¸ºç©º!";
          if (input.length > 72) return "ä¸è¶…è¿‡72ä¸ªå­—ç¬¦!";
          return true;
        },
      },
      {
        type: "editor",
        name: "body",
        message: "è¾“å…¥è¯¦ç»†è¯´æ˜ (å¯é€‰):",
        wait: true,
      },
      {
        type: "confirm",
        name: "isBreaking",
        message: "åŒ…å«ç ´åæ€§å˜æ›´?",
        default: false,
      },
      {
        type: "input",
        name: "footer",
        message: "è¾“å…¥å…³è”çš„ Issue (å¦‚ #123):",
        default: () => getBranchInfo().issue || "",
        when: (answers) => !answers.isBreaking,
      },
    ]);

    // æ„å»ºæäº¤ä¿¡æ¯
    const message = [
      `${answers.type}(${answers.scope}): ${answers.subject}`,
      answers.body,
      answers.isBreaking ? `BREAKING CHANGE: ${answers.body}` : "",
      answers.footer ? `Closes ${answers.footer}` : "",
    ]
      .filter(Boolean)
      .join("\n\n");

    // å†™å…¥æäº¤ä¿¡æ¯æ–‡ä»¶
    fs.writeFileSync(commitMsgFile, message, "utf-8");
    console.log(chalk.green("\nâœ… æäº¤ä¿¡æ¯å·²ç”Ÿæˆ!"));
  } catch (err) {
    console.error(chalk.red("âŒ ç”Ÿæˆå¤±è´¥:", err));
    process.exit(1);
  }
}

run();
```

### Commitizen

Commitizenå¯ä»¥ä½¿ç”¨å°è£…å¥½çš„å·¥å…·ï¼Œé€‰æ‹©é€‚é…å™¨ `cz-conventional-changelog` å…é…ç½®å¿«é€ŸæŒ‰ä¸»æµçš„å¼€æºè§„èŒƒç”Ÿæˆcommitï¼Œä½†æ˜¯æˆ‘æ›´å–œæ¬¢ç”¨ `cz-customizable` é€‚é…å™¨è‡ªå®šä¹‰ï¼Œåªéœ€ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ï¼Œçœå»äº†è‡ªå·±å†™è„šæœ¬çš„éº»çƒ¦ã€‚æ‰€ä»¥ä»¥ä¸‹æ˜¯cz-customizableçš„æ¼”ç¤º

åœ¨é¡¹ç›®ä¸­å®‰è£…

```bash
npm install -D commitizen cz-customizable
```

é…ç½®æ–‡ä»¶ `.cz-config.js` å‚è€ƒ

```js
module.exports = {
  types: [
    { value: 'feat',     name: 'feat:     æ–°åŠŸèƒ½' },
    { value: 'fix',      name: 'fix:      Bugä¿®å¤' },
    { value: 'docs',     name: 'docs:     æ–‡æ¡£å˜æ›´' },
    { value: 'style',    name: 'style:    ä»£ç æ ·å¼' },
    { value: 'refactor', name: 'refactor: ä»£ç é‡æ„' },
    { value: 'perf',     name: 'perf:     æ€§èƒ½ä¼˜åŒ–' },
    { value: 'test',     name: 'test:     æµ‹è¯•ç›¸å…³' },
    { value: 'chore',    name: 'chore:    æ„å»º/å·¥å…·' },
    { value: 'revert',   name: 'revert:   å›æ»šæäº¤' }
  ],
  scopes: [
    { name: 'user' },
    { name: 'order' },
    { name: 'payment' },
    { name: 'config' }
  ],
  messages: {
    type: 'é€‰æ‹©æäº¤ç±»å‹:',
    scope: 'é€‰æ‹©å½±å“èŒƒå›´:',
    customScope: 'è¾“å…¥è‡ªå®šä¹‰èŒƒå›´:',
    subject: 'è¾“å…¥ç®€çŸ­æè¿° (72å­—ç¬¦å†…):\n',
    body: 'è¾“å…¥è¯¦ç»†è¯´æ˜ (å¯é€‰):\n',
    breaking: 'åˆ—å‡ºç ´åæ€§å˜æ›´ (å¯é€‰):\n',
    footer: 'å…³è”çš„ Issue (å¦‚ #123):\n',
    confirmCommit: 'ç¡®è®¤æäº¤ä¿¡æ¯?'
  },
  allowCustomScopes: true,
  allowBreakingChanges: ['feat', 'fix'],
  skipQuestions: ['footer'],
  subjectLimit: 72
}
```

é…ç½® `package.json` 

```js
{
  "config": {
    "commitizen": {
      "path": "node_modules/cz-customizable"
    },
    "cz-customizable": {
      "config": ".cz-config.js"
    }
  }
}
```

huskyå¢åŠ `prepare-commit-msg`é’©å­

```bash
npx husky add .husky/prepare-commit-msg "exec < /dev/tty && node_modules/.bin/git-cz --hook || true"
```

## æ€»ç»“

ä»¥ä¸Šä¾¿æ˜¯å®Œæ•´çš„å‰ç«¯é¡¹ç›®è§„èŒƒè‡ªåŠ¨åŒ–çš„å»ºè®¾æ–¹æ¡ˆï¼Œé€šè¿‡è¿™å¥—æ–¹æ¡ˆçš„é›†æˆï¼Œä½ çš„é¡¹ç›®åœ¨å¤šäººåä½œä¸­éƒ½èƒ½å‘ˆç°å‡ºç»Ÿä¸€çš„é£æ ¼å’Œè§„èŒƒï¼Œå¹¶ä¸”é…ç½®å®Œæˆåï¼Œéƒ½å¯ä»¥ä½œä¸ºåŸºå»ºå¤ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸­ï¼Œä»¥åä¾¿èƒ½ç»Ÿä¸€æ‰€æœ‰é¡¹ç›®çš„é£æ ¼ï¼Œå½¢æˆä½ å…¬å¸çš„å‰ç«¯è§„èŒƒã€‚